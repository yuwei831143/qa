{% extends 'base_layout.html' %}
{% block title %}{{ super() }} - 写文章{% endblock %}
{% from 'macro/form_errors.html' import form_field_errors %}
{% block header %}
  <link rel="stylesheet" href="./assets/style/write.css">
  {% endblock %}
{% block content %}

  <div class="container">
    <div class="row">
      <div class="col-md-8 col-md-offset-2">
        <form class="form-horizontal write-form" method="post" enctype="multipart/form-data" action="{{ url_for('qa.write') }}">
            {{ form.csrf_token }}
          <div class="form-group">
            <button type="submit" class="btn btn-info pull-right">发布</button>
          </div>
          <div class="form-group">
            <label class="upload-file">
              {{ form.img }}
              <i class="glyphicon glyphicon-camera"></i>
            </label>
          </div>
            {{ form_field_errors(form.img.errors) }}
          <div class="form-group">
              {{ form.title }}

          </div>
            {{ form_field_errors(form.title.errors) }}
          <div class="form-group">
              {{ form.tags }}

          </div>
            {{ form_field_errors(form.tags.errors) }}
          <div class="form-group">
              {{ form.desc }}

          </div>
            {{ form_field_errors(form.desc.errors) }}
          <div class="form-group">
              {{ form.content }}
              {{ ckeditor.load() }}
              {{ ckeditor.config(name='content') }}

          </div>
            {{ form_field_errors(form.content.errors) }}
        </form>
      </div>
    </div>
  </div>
{% endblock %}

{% block js_extra %}
  <!-- jQuery (Bootstrap 的所有 JavaScript 插件都依赖 jQuery，所以必须放在前边) -->
  <script src="./assets/plugins/jquery-3.4.1.min.js"></script>
  <!-- 加载 Bootstrap 的所有 JavaScript 插件。你也可以根据需要只加载单个插件。 -->
  <script src="./assets/plugins/bootstrap/js/bootstrap.min.js"></script>
  <script>
    $(function () {
      // 文件选择后，在浏览器中预览
      $('input[type=file]').change(function () {
        var file = this.files[0];
        var reader = new FileReader();
        reader.onload = function () {
          $('.upload-file').css('background-image', 'url(' + reader.result + ')')
        }
        reader.readAsDataURL(file);
      })
    })
  </script>

{% endblock %}